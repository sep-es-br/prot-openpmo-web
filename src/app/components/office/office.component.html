<div class="main-title" *ngIf="action == 'new'"><span i18n="@@translation_New-office">New office</span></div>
<div class="main-title" *ngIf="action != 'new'">{{office.name}}</div>
<div class="panel-container">
  <mat-accordion >
    <!-- Properties Panel -->
    <mat-expansion-panel 
      [expanded]="propertiesPanelOpenState"
      (opened)="propertiesPanelOpenState = true"
      (closed)="propertiesPanelOpenState = false">
      <mat-expansion-panel-header>
        <mat-panel-title i18n="@@translation_Properties">
          Properties
        </mat-panel-title>
      </mat-expansion-panel-header>
      <form 
        name="officeForm" 
        (ngSubmit)="f.form.valid && onSubmit()" 
        #f="ngForm"
        class="form-container"
        novalidate>  
        <mat-form-field>
          <input matInput
            type="text"
            [formControl]="nameFormControl"
            placeholder="Name"
            required
            [(ngModel)]="office.name"/> 
        </mat-form-field>
        <mat-error *ngIf="nameFormControl.invalid && nameFormControl.touched">
          <span i18n="@@translation_Name-is">Name is </span> <strong i18n="@@translation_required">required</strong>
        </mat-error>
        <mat-form-field>
          <input matInput 
            type="text" 
            [formControl]="shortNameFormControl"
            placeholder="Short Name"
            required
            [(ngModel)]="office.shortName"/>
        </mat-form-field>
        <mat-error *ngIf="shortNameFormControl.invalid && shortNameFormControl.touched">
          <span i18n="@@translation_Name-is">Name is </span> <strong i18n="@@translation_required">required</strong>
        </mat-error>

        <button mat-raised-button i18n="@@translation_Save">Save</button>

      </form>
    </mat-expansion-panel>
    
    <!-- Planning Schemas Panel -->
    <mat-expansion-panel
      *ngIf="action != 'new'"
      [expanded]="schemasPanelOpenState"
      (opened)="schemasPanelOpenState = true"
      (closed)="schemasPanelOpenState = false">
      
      <!-- Header -->
      <mat-expansion-panel-header>
        <mat-panel-title i18n="@@translation_Planning">
          Planning
        </mat-panel-title>
      </mat-expansion-panel-header>
      
        <!-- Body -->
        <div class="container-fluid cards">
          <div class="row">
            <mat-card class="card card-style" *ngFor="let schema of office.schemas">
              <div class="card-setting" id="dropdownMenuButton" data-toggle="dropdown">
                <mat-icon fontSet="fa" fontIcon="fa-bars"></mat-icon>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" (click)="DeleteSchema(schema.id)" i18n="@@translation_Delete">Delete</a>
                </div>
              </div>
              <mat-card-title class="title-card">
                <a  routerLink="/schema/edit/{{schema.id}}&{{schema.template?.id}}" 
                routerLinkActive="active">{{schema.name}}</a>
              </mat-card-title>
              <mat-card-content class="img-card">
                <mat-icon fontSet="fas" fontIcon="fa-project-diagram"></mat-icon>   
              </mat-card-content>
            </mat-card>

            <mat-card class="card card-style new-card" *ngFor="let schema of office.schemas">
              <div *ngIf="office.schemaTemplates.length > 0">
                <div class="card-image-new dropleft" id="dropdownMenuButton" data-toggle="dropdown">
                  <mat-icon fontSet="fa" fontIcon="fa-plus"></mat-icon>
                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <a *ngFor="let template of office.schemaTemplates" 
                    class="dropdown-item" 
                    routerLink="/schema/new/{{office.id}}&{{template.id}}" 
                    routerLinkActive="active">{{template.name}}</a>
                  </div>
                </div>
              </div>
            </mat-card>
          </div>
        </div>

    </mat-expansion-panel>
  
  </mat-accordion>
</div>

